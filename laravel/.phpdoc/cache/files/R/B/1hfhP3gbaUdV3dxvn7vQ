1711241706
waR3U4bTeM%3Abe847579ecebee6f41ccdc9450576968-429111360e1590f575d210d10085b87a
s:9668:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6IjQyOTExMTM2MGUxNTkwZjU3NWQyMTBkMTAwODViODdhIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6MzE6ImJ1bGtfYWN0aW9uc19jaGVja2JveC5ibGFkZS5waHAiO3M6Mzk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAcGF0aCI7czo4OToidmVuZG9yL2JhY2twYWNrL2NydWQvc3JjL3Jlc291cmNlcy92aWV3cy9jcnVkL2NvbHVtbnMvaW5jL2J1bGtfYWN0aW9uc19jaGVja2JveC5ibGFkZS5waHAiO3M6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAc291cmNlIjtzOjYyNjM6IkBpZiAoIWlzc2V0KCRlbnRyeSkpCiAgICA8c3BhbiBjbGFzcz0iY3J1ZF9idWxrX2FjdGlvbnNfY2hlY2tib3giPgogICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgY2xhc3M9ImNydWRfYnVsa19hY3Rpb25zX2dlbmVyYWxfY2hlY2tib3giPgogICAgPC9zcGFuPgpAZWxzZQogICAgPHNwYW4gY2xhc3M9ImNydWRfYnVsa19hY3Rpb25zX2NoZWNrYm94Ij4KICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNsYXNzPSJjcnVkX2J1bGtfYWN0aW9uc19saW5lX2NoZWNrYm94IiBkYXRhLXByaW1hcnkta2V5LXZhbHVlPSJ7eyAkZW50cnktPmdldEtleSgpIH19Ij4KICAgIDwvc3Bhbj4KCiAgICBAbG9hZE9uY2UoJ2JwRmllbGRJbml0Q2hlY2tib3hTY3JpcHQnKQogICAgPHNjcmlwdD4KICAgIGlmICh0eXBlb2YgYWRkT3JSZW1vdmVDcnVkQ2hlY2tlZEl0ZW0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBmdW5jdGlvbiBhZGRPclJlbW92ZUNydWRDaGVja2VkSXRlbShlbGVtZW50KSB7CiAgICAgICAgICAgIGNydWQubGFzdENoZWNrZWRJdGVtID0gZmFsc2U7CgogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dC5jcnVkX2J1bGtfYWN0aW9uc19saW5lX2NoZWNrYm94JykuZm9yRWFjaChjaGVja2JveCA9PiBjaGVja2JveC5vbmNsaWNrID0gZSA9PiB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwoKICAgICAgICAgICAgICAgIGxldCBjaGVja2VkID0gY2hlY2tib3guY2hlY2tlZDsKICAgICAgICAgICAgICAgIGxldCBwcmltYXJ5S2V5VmFsdWUgPSBjaGVja2JveC5kYXRhc2V0LnByaW1hcnlLZXlWYWx1ZTsKCiAgICAgICAgICAgICAgICBjcnVkLmNoZWNrZWRJdGVtcyA/Pz0gW107CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChjaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGl0ZW0gdG8gY3J1ZC5jaGVja2VkSXRlbXMgdmFyaWFibGUKICAgICAgICAgICAgICAgICAgICBjcnVkLmNoZWNrZWRJdGVtcy5wdXNoKHByaW1hcnlLZXlWYWx1ZSk7CgogICAgICAgICAgICAgICAgICAgIC8vIGlmIHNoaWZ0IGhhcyBiZWVuIHByZXNzZWQsIGFsc28gc2VsZWN0IGFsbCBlbGVtZW50cwogICAgICAgICAgICAgICAgICAgIC8vIGJldHdlZW4gdGhlIGxhc3QgY2hlY2tlZCBpdGVtIGFuZCB0aGlzIG9uZQogICAgICAgICAgICAgICAgICAgIGlmIChjcnVkLmxhc3RDaGVja2VkSXRlbSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBnZXROb2RlaW5kZXggPSBlbG0gPT4gWy4uLmVsbS5wYXJlbnROb2RlLmNoaWxkcmVuXS5pbmRleE9mKGVsbSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaXJzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGlucHV0LmNydWRfYnVsa19hY3Rpb25zX2xpbmVfY2hlY2tib3hbZGF0YS1wcmltYXJ5LWtleS12YWx1ZT0iJHtjcnVkLmxhc3RDaGVja2VkSXRlbX0iXWApLmNsb3Nlc3QoJ3RyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsYXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgaW5wdXQuY3J1ZF9idWxrX2FjdGlvbnNfbGluZV9jaGVja2JveFtkYXRhLXByaW1hcnkta2V5LXZhbHVlPSIke3ByaW1hcnlLZXlWYWx1ZX0iXWApLmNsb3Nlc3QoJ3RyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaXJzdEluZGV4ID0gZ2V0Tm9kZWluZGV4KGZpcnN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxhc3RJbmRleCA9IGdldE5vZGVpbmRleChsYXN0KQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoZmlyc3QgIT09IGxhc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gZmlyc3RJbmRleCA8IGxhc3RJbmRleCA/IGZpcnN0Lm5leHRFbGVtZW50U2libGluZyA6IGZpcnN0LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdC5xdWVyeVNlbGVjdG9yKCdpbnB1dC5jcnVkX2J1bGtfYWN0aW9uc19saW5lX2NoZWNrYm94Om5vdCg6Y2hlY2tlZCknKT8uY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gcmVtZW1iZXIgdGhhdCB0aGlzIG9uZSB3YXMgdGhlIGxhc3QgY2hlY2tlZCBpdGVtCiAgICAgICAgICAgICAgICAgICAgY3J1ZC5sYXN0Q2hlY2tlZEl0ZW0gPSBwcmltYXJ5S2V5VmFsdWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBpdGVtIGZyb20gY3J1ZC5jaGVja2VkSXRlbXMgdmFyaWFibGUKICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBjcnVkLmNoZWNrZWRJdGVtcy5pbmRleE9mKHByaW1hcnlLZXlWYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIGNydWQuY2hlY2tlZEl0ZW1zLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gaWYgbm8gaXRlbXMgYXJlIHNlbGVjdGVkLCBkaXNhYmxlIGFsbCBidWxrIGJ1dHRvbnMKICAgICAgICAgICAgICAgIGVuYWJsZU9yRGlzYWJsZUJ1bGtCdXR0b25zKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZW9mIG1hcmtDaGVja2JveEFzQ2hlY2tlZElmUHJldmlvdXNseVNlbGVjdGVkICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZnVuY3Rpb24gbWFya0NoZWNrYm94QXNDaGVja2VkSWZQcmV2aW91c2x5U2VsZWN0ZWQoKSB7CiAgICAgICAgICAgIGxldCBjaGVja2VkSXRlbXMgPSBjcnVkLmNoZWNrZWRJdGVtcyA/PyBbXTsKICAgICAgICAgICAgbGV0IHBhZ2VDaGFuZ2VkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3BhZ2VfY2hhbmdlZCcpID8/IGZhbHNlOwogICAgICAgICAgICBsZXQgdGFibGVVcmwgPSBjcnVkLnRhYmxlLmFqYXgudXJsKCk7CiAgICAgICAgICAgIGxldCBoYXNGaWx0ZXJBcHBsaWVkID0gZmFsc2U7CgogICAgICAgICAgICBpZiAodGFibGVVcmwuaW5kZXhPZignPycpID4gLTEpIHsKICAgICAgICAgICAgICAgIGlmICh0YWJsZVVybC5zdWJzdHJpbmcodGFibGVVcmwuaW5kZXhPZignPycpICsgMSkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGhhc0ZpbHRlckFwcGxpZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBpZiBpdCB3YXMgbm90IGEgcGFnZSBjaGFuZ2UsIHdlIGNoZWNrIGlmIGRhdGF0YWJsZXMgaGF2ZSBhbnkgc2VhcmNoLCBvciB0aGUgdXJsIGhhdmUgYW55IHBhcmFtZXRlcnMuCiAgICAgICAgICAgIC8vIGlmIHlvdSBoYXZlIGZpbHRlcmVkIGVudHJpZXMsIGFuZCB0aGVuIHJlbW92ZSB0aGUgZmlsdGVycyB3ZSBhcmUgc3VyZSB0aGUgZW50cmllcyBhcmUgaW4gdGhlIHRhYmxlLgogICAgICAgICAgICAvLyB3ZSBkb24ndCByZW1vdmUgdGhlbSBpbiB0aGF0IGNhc2UuCiAgICAgICAgICAgIGlmICghIHBhZ2VDaGFuZ2VkICYmIChjcnVkLnRhYmxlLnNlYXJjaCgpLmxlbmd0aCAhPT0gMCB8fCBoYXNGaWx0ZXJBcHBsaWVkKSkgewogICAgICAgICAgICAgICAgY3J1ZC5jaGVja2VkSXRlbXMgPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkb2N1bWVudAogICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0LmNydWRfYnVsa19hY3Rpb25zX2xpbmVfY2hlY2tib3hbZGF0YS1wcmltYXJ5LWtleS12YWx1ZV0nKQogICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24oZWxlbSkgewogICAgICAgICAgICAgICAgICAgIGxldCBjaGVja2VkID0gY2hlY2tlZEl0ZW1zLmxlbmd0aCAmJiBjaGVja2VkSXRlbXMuaW5kZXhPZihlbGVtLmRhdGFzZXQucHJpbWFyeUtleVZhbHVlKSA+IC0xOwogICAgICAgICAgICAgICAgICAgIGVsZW0uY2hlY2tlZCA9IGNoZWNrZWQ7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQgJiYgY3J1ZC5jaGVja2VkSXRlbXMuaW5kZXhPZihlbGVtLmRhdGFzZXQucHJpbWFyeUtleVZhbHVlKSA9PT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3J1ZC5jaGVja2VkSXRlbXMucHVzaChlbGVtLmRhdGFzZXQucHJpbWFyeUtleVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYWdlX2NoYW5nZWQnKTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiBhZGRCdWxrQWN0aW9uTWFpbkNoZWNrYm94ZXNGdW5jdGlvbmFsaXR5ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZnVuY3Rpb24gYWRkQnVsa0FjdGlvbk1haW5DaGVja2JveGVzRnVuY3Rpb25hbGl0eSgpIHsKICAgICAgICAgICAgbGV0IG1haW5DaGVja2JveGVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dC5jcnVkX2J1bGtfYWN0aW9uc19nZW5lcmFsX2NoZWNrYm94JykpOwogICAgICAgICAgICBsZXQgcm93Q2hlY2tib3hlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQuY3J1ZF9idWxrX2FjdGlvbnNfbGluZV9jaGVja2JveCcpKTsKCiAgICAgICAgICAgIG1haW5DaGVja2JveGVzLmZvckVhY2goY2hlY2tib3ggPT4gewogICAgICAgICAgICAgICAgLy8gc2V0IGluaXRpYWwgY2hlY2tlZCBzdGF0dXMKICAgICAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dC5jcnVkX2J1bGtfYWN0aW9uc19saW5lX2NoZWNrYm94Om5vdCg6Y2hlY2tlZCknKS5sZW5ndGggPT09IDA7CgogICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgY3J1ZF9idWxrX2FjdGlvbnNfZ2VuZXJhbF9jaGVja2JveCBpcyBzZWxlY3RlZCwgdG9nZ2xlIGFsbCB2aXNpYmxlIGNoZWNrYm94ZXMKICAgICAgICAgICAgICAgIGNoZWNrYm94Lm9uY2xpY2sgPSBldmVudCA9PiB7CiAgICAgICAgICAgICAgICAgICAgcm93Q2hlY2tib3hlcy5maWx0ZXIoZWxlbSA9PiBjaGVja2JveC5jaGVja2VkICE9PSBlbGVtLmNoZWNrZWQpLmZvckVhY2goZWxlbSA9PiBlbGVtLmNsaWNrKCkpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgb3RoZXIgY2hlY2tib3ggaGFzIHRoZSBzYW1lIGNoZWNrZWQgc3RhdHVzCiAgICAgICAgICAgICAgICAgICAgbWFpbkNoZWNrYm94ZXMuZm9yRWFjaChlbGVtID0+IGVsZW0uY2hlY2tlZCA9IGNoZWNrYm94LmNoZWNrZWQpOwoKICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBTdG9wIHByb3BhZ2F0aW9uIG9mIGhyZWYgb24gdGhlIGZpcnN0IGNvbHVtbgogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0YWJsZSB0ZC5kdHItY29udHJvbCBhJykuZm9yRWFjaChsaW5rID0+IGxpbmsub25jbGljayA9IGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7CiAgICAgICAgfQogICAgfQoKICAgIGlmICh0eXBlb2YgZW5hYmxlT3JEaXNhYmxlQnVsa0J1dHRvbnMgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBmdW5jdGlvbiBlbmFibGVPckRpc2FibGVCdWxrQnV0dG9ucygpIHsKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ1bGstYnV0dG9uJykuZm9yRWFjaChidG4gPT4gYnRuLmNsYXNzTGlzdC50b2dnbGUoJ2Rpc2FibGVkJywgIWNydWQuY2hlY2tlZEl0ZW1zPy5sZW5ndGgpKTsKICAgICAgICB9CiAgICB9CgogICAgY3J1ZC5hZGRGdW5jdGlvblRvRGF0YVRhYmxlc0RyYXdFdmVudFF1ZXVlKCdhZGRPclJlbW92ZUNydWRDaGVja2VkSXRlbScpOwogICAgY3J1ZC5hZGRGdW5jdGlvblRvRGF0YVRhYmxlc0RyYXdFdmVudFF1ZXVlKCdtYXJrQ2hlY2tib3hBc0NoZWNrZWRJZlByZXZpb3VzbHlTZWxlY3RlZCcpOwogICAgY3J1ZC5hZGRGdW5jdGlvblRvRGF0YVRhYmxlc0RyYXdFdmVudFF1ZXVlKCdhZGRCdWxrQWN0aW9uTWFpbkNoZWNrYm94ZXNGdW5jdGlvbmFsaXR5Jyk7CiAgICBjcnVkLmFkZEZ1bmN0aW9uVG9EYXRhVGFibGVzRHJhd0V2ZW50UXVldWUoJ2VuYWJsZU9yRGlzYWJsZUJ1bGtCdXR0b25zJyk7CiAgICA8L3NjcmlwdD4KICAgIEBlbmRMb2FkT25jZQpAZW5kaWYKIjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWVzcGFjZXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW5jbHVkZXMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZnVuY3Rpb25zIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNvbnN0YW50cyI7YTowOnt9czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjbGFzc2VzIjthOjA6e31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGludGVyZmFjZXMiO2E6MDp7fXM6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAdHJhaXRzIjthOjA6e31zOjQwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGVudW1zIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG1ldGFkYXRhIjthOjA6e319";